function isElevated() {
    var isElevated = true;

    try {
        var wsh = WScript.CreateObject('WScript.Shell');

        wsh.RegRead('HKEY_USERS\\S-1-5-19\\Environment\\TEMP');
    } catch (e) {
        isElevated = false;
    }

    return isElevated;
}

var props = ['FullName', 'Interactive', 'Name', 'Path', 'Arguments', 'BuildVersion', 'ScriptName', 'ScriptFullName', 'Version'];
for (var i in props) {
    WScript.Echo('WScript.' + props[i] + ': ' + WScript[props[i]]);
}

if (isElevated()) {
    WScript.Echo('You are elevated');
} else {
    WScript.Echo('You are not elevated, relaunching as elevated');
    var uac = WScript.CreateObject('Shell.Application');
    uac.shellExecute(WScript.FullName, WScript.ScriptFullName, '', 'runas', 1);
}
